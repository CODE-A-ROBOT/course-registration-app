<!-- index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kurswahl</title>
</head>
<body>

    <h1>Kurswahl </h1>

    <form id="courseForm">
      <h2>Prüfungsfächer</h2>

      <h3>Schule</h3>

      <div class="course-selection">
        <label for="schoolSelect">Schule:</label>
        <select id="schoolSelect" name="schoolSelect" onchange="filterOptions('schoolSelect', 'column1Select')"></select>
      </div>

      <h3>Leistungskursfächer</h3>
      <div class="course-selection">
        <label for="column1Select">Leistungskursfach 1:</label>
        <select id="column1Select" name="column1Select" onchange="filterOptions('column1Select', 'column2Select')"></select>
      </div>
  
      <div class="course-selection">
        <label for="courseSelectL2">Leistungskursfach 2:</label>
        <select id="column2Select" name="column2Select" onchange="filterOptions('column2Select', 'column3Select')"></select>
      </div>
  
      <h3>Prüfungsfächer</h3>
      <div class="course-selection">
        <label for="courseSelectL3">Prüfungsfach 3:</label>
        <select id="column3Select" name="column3Select" onchange="filterOptions('column3Select', 'column4Select')"></select>
      </div>
  
      <div class="course-selection">
        <label for="courseSelectL4">Prüfungsfach 4:</label>
        <select id="column4Select" name="column4Select" onchange="filterOptions('column4Select', 'column5Select')"></select>
      </div>
      
  
      <h3>5. PK</h3>
      <div class="course-selection">
        <label for="courseSelectL5">Referenzfach:</label>
        <select id="column5Select" name="column5Select" onchange="filterOptions('column5Select', 'column6Select')"></select>
      </div>
  
      <h3>weitere Grundkurse mit Belegverpflichtung</h3>
      <div class="course-selection">
        <label for="courseSelectL6">De:</label>
        <select id="column6Select" name="column6Select" onchange="filterOptions('column6Select', 'column7Select')"></select>
      </div>
  
      <div class="course-selection">
        <label for="courseSelectL7">FS</label>
        <select id="column7Select" name="column7Select" onchange="filterOptions('column7Select', 'column8Select')"></select>
      </div>
  
      <div class="course-selection">
        <label for="courseSelectL8">Ge:</label>
        <select id="column8Select" name="column8Select" onchange="filterOptions('column8Select', 'column9Select')"></select>
      </div>
      
      <div class="course-selection">
        <label for="courseSelectL9">PW</label>
        <select id="column9Select" name="column9Select" onchange="filterOptions('column9Select', 'column10Select')"></select>
      </div>
  
      <div class="course-selection">
        <label for="courseSelectL10">Ma</label>
        <select id="column10Select" name="column10Select"></select>
      </div>


    <br>
    <button type="button" onclick="submitForm()">Submit</button>
  </form>

  <script>
    let data; // Declare the data variable



    async function filterOptions(sourceSelectId, targetSelectId) {
      const sourceSelect = document.getElementById(sourceSelectId);
      const targetSelect = document.getElementById(targetSelectId);

      // Get the selected value from the source select
      const selectedValue = sourceSelect.value;

      // Filter the data based on the selected value
      const filteredData = data.filter(item => item[sourceSelectId] === selectedValue);

      // Repopulate the target select with the first available option
      fetchAndPopulateSelect(targetSelectId, filteredData);

      // Trigger change event for the target select to continue the cascade
      const event = new Event('change');
      targetSelect.dispatchEvent(event);
    }

// Updated fetchAndPopulateSelect function
async function fetchAndPopulateSelect(selectId, data) {
  const select = document.getElementById(selectId);
  // Clear existing options
  select.innerHTML = '';

  // Create the default option for the school dropdown
  if (selectId === 'schoolSelect') {
    const defaultOption = document.createElement('option');
    defaultOption.value = '';
    defaultOption.text = 'Select...';
    select.appendChild(defaultOption);
  }
  const uniqueValues = [...new Set(data.map(item => item[selectId]))];
  uniqueValues.forEach(value => {
    console.log('value: ' + value);
    const option = document.createElement('option');
    option.value = value;
    option.text = value;
    select.appendChild(option);
  });
}



// Updated fetchCourses function
async function fetchCourses() {
  try {
    const response = await fetch('data.json');
    if (!response.ok) {
      throw new Error(`Failed to fetch data.json. Status: ${response.status}`);
    }
    data = await response.json();

    // Fetch and populate the School select
    fetchAndPopulateSelect('schoolSelect', data);
  } catch (error) {
    console.error(error);
  }
}


    // Fetch courses when the page loads
    document.addEventListener('DOMContentLoaded', fetchCourses);

    // Additional function to submit the form
    function submitForm() {
      // Add your logic to handle the selected values (e.g., send them to the server)
      // Access the selected values using document.getElementById('selectId').value
      console.log('Form submitted!');
    }
  </script>
</body>
</html>
